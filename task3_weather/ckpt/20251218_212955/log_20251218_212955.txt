2025-12-18 21:29:55,419 - INFO - ==================================================
2025-12-18 21:29:55,419 - INFO - 开始运行程序
2025-12-18 21:29:55,419 - INFO - 随机种子已固定: 42
2025-12-18 21:29:55,419 - INFO - 保存目录: ckpt\20251218_212955
2025-12-18 21:29:55,421 - INFO - 
模型配置：
2025-12-18 21:29:55,421 - INFO -   LSTM层数: 2
2025-12-18 21:29:55,421 - INFO -   使用注意力机制: True
2025-12-18 21:29:55,437 - INFO - 当前设备：cuda
2025-12-18 21:29:55,497 - INFO - 数据形状：(26200, 22)
2025-12-18 21:29:55,510 - INFO - 
   date              p (mbar)   T (degC)   Tpot (K)  ...   PAR (�mol/m�?s)   max. PAR (�mol/m�?s)   Tlog (degC)     OT
0  2020/1/1 0:10      1008.89       0.71     273.18  ...               0.0                    0.0         11.45  428.1
1  2020/1/1 0:20      1008.76       0.75     273.22  ...               0.0                    0.0         11.51  428.0
2  2020/1/1 0:30      1008.66       0.73     273.21  ...               0.0                    0.0         11.60  427.6
3  2020/1/1 0:40      1008.64       0.37     272.86  ...               0.0                    0.0         11.70  430.0
4  2020/1/1 0:50      1008.61       0.33     272.82  ...               0.0                    0.0         11.81  432.2

[5 rows x 22 columns]
2025-12-18 21:29:55,510 - INFO - 
所有列名：
2025-12-18 21:29:55,511 - INFO - 0: 'date' (repr: 'date')
2025-12-18 21:29:55,511 - INFO - 1: 'p (mbar)' (repr: 'p (mbar)')
2025-12-18 21:29:55,511 - INFO - 2: 'T (degC)' (repr: 'T (degC)')
2025-12-18 21:29:55,511 - INFO - 3: 'Tpot (K)' (repr: 'Tpot (K)')
2025-12-18 21:29:55,511 - INFO - 4: 'Tdew (degC)' (repr: 'Tdew (degC)')
2025-12-18 21:29:55,511 - INFO - 5: 'rh (%)' (repr: 'rh (%)')
2025-12-18 21:29:55,511 - INFO - 6: 'VPmax (mbar)' (repr: 'VPmax (mbar)')
2025-12-18 21:29:55,511 - INFO - 7: 'VPact (mbar)' (repr: 'VPact (mbar)')
2025-12-18 21:29:55,511 - INFO - 8: 'VPdef (mbar)' (repr: 'VPdef (mbar)')
2025-12-18 21:29:55,511 - INFO - 9: 'sh (g/kg)' (repr: 'sh (g/kg)')
2025-12-18 21:29:55,511 - INFO - 10: 'H2OC (mmol/mol)' (repr: 'H2OC (mmol/mol)')
2025-12-18 21:29:55,511 - INFO - 11: 'rho (g/m**3)' (repr: 'rho (g/m**3)')
2025-12-18 21:29:55,512 - INFO - 12: 'wv (m/s)' (repr: 'wv (m/s)')
2025-12-18 21:29:55,512 - INFO - 13: 'max. wv (m/s)' (repr: 'max. wv (m/s)')
2025-12-18 21:29:55,512 - INFO - 14: 'wd (deg)' (repr: 'wd (deg)')
2025-12-18 21:29:55,512 - INFO - 15: 'rain (mm)' (repr: 'rain (mm)')
2025-12-18 21:29:55,512 - INFO - 16: 'raining (s)' (repr: 'raining (s)')
2025-12-18 21:29:55,512 - INFO - 17: 'SWDR (W/m�?' (repr: 'SWDR (W/m�?')
2025-12-18 21:29:55,512 - INFO - 18: 'PAR (�mol/m�?s)' (repr: 'PAR (�mol/m�?s)')
2025-12-18 21:29:55,512 - INFO - 19: 'max. PAR (�mol/m�?s)' (repr: 'max. PAR (�mol/m�?s)')
2025-12-18 21:29:55,512 - INFO - 20: 'Tlog (degC)' (repr: 'Tlog (degC)')
2025-12-18 21:29:55,512 - INFO - 21: 'OT' (repr: 'OT')
2025-12-18 21:29:55,523 - INFO - 训练集 shape：(20960, 21)
2025-12-18 21:29:55,523 - INFO - 测试集 shape：(5240, 21)
2025-12-18 21:29:55,574 - INFO - 
最终数据维度：
2025-12-18 21:29:55,574 - INFO - X_train: (20948, 12, 21)
2025-12-18 21:29:55,574 - INFO - y_train: (20948,)
2025-12-18 21:29:55,574 - INFO - X_test: (5228, 12, 21)
2025-12-18 21:29:55,574 - INFO - y_test: (5228,)
2025-12-18 21:29:56,797 - INFO - 
====== 开始训练模型 ======

2025-12-18 21:29:58,306 - INFO - Epoch 1/30 - Train Loss: 0.059142
2025-12-18 21:29:59,537 - INFO - Epoch 2/30 - Train Loss: 0.059032
2025-12-18 21:30:00,717 - INFO - Epoch 3/30 - Train Loss: 0.058652
2025-12-18 21:30:01,926 - INFO - Epoch 4/30 - Train Loss: 0.058497
2025-12-18 21:30:03,371 - INFO - Epoch 5/30 - Train Loss: 0.058370
2025-12-18 21:30:04,703 - INFO - Epoch 6/30 - Train Loss: 0.058785
2025-12-18 21:30:05,901 - INFO - Epoch 7/30 - Train Loss: 0.058491
2025-12-18 21:30:07,070 - INFO - Epoch 8/30 - Train Loss: 0.058269
2025-12-18 21:30:08,254 - INFO - Epoch 9/30 - Train Loss: 0.058313
2025-12-18 21:30:09,815 - INFO - Epoch 10/30 - Train Loss: 0.058178
2025-12-18 21:30:11,271 - INFO - Epoch 11/30 - Train Loss: 0.058020
2025-12-18 21:30:12,750 - INFO - Epoch 12/30 - Train Loss: 0.057915
2025-12-18 21:30:14,243 - INFO - Epoch 13/30 - Train Loss: 0.058138
2025-12-18 21:30:15,435 - INFO - Epoch 14/30 - Train Loss: 0.057442
2025-12-18 21:30:16,617 - INFO - Epoch 15/30 - Train Loss: 0.057844
2025-12-18 21:30:17,786 - INFO - Epoch 16/30 - Train Loss: 0.057288
2025-12-18 21:30:19,098 - INFO - Epoch 17/30 - Train Loss: 0.057019
2025-12-18 21:30:20,620 - INFO - Epoch 18/30 - Train Loss: 0.056681
2025-12-18 21:30:22,083 - INFO - Epoch 19/30 - Train Loss: 0.056077
2025-12-18 21:30:23,539 - INFO - Epoch 20/30 - Train Loss: 0.058043
2025-12-18 21:30:24,911 - INFO - Epoch 21/30 - Train Loss: 0.056501
2025-12-18 21:30:26,138 - INFO - Epoch 22/30 - Train Loss: 0.056369
2025-12-18 21:30:27,200 - INFO - Epoch 23/30 - Train Loss: 0.055945
2025-12-18 21:30:28,354 - INFO - Epoch 24/30 - Train Loss: 0.055669
2025-12-18 21:30:29,614 - INFO - Epoch 25/30 - Train Loss: 0.055982
2025-12-18 21:30:30,776 - INFO - Epoch 26/30 - Train Loss: 0.055225
2025-12-18 21:30:31,871 - INFO - Epoch 27/30 - Train Loss: 0.056483
2025-12-18 21:30:32,944 - INFO - Epoch 28/30 - Train Loss: 0.056549
2025-12-18 21:30:34,008 - INFO - Epoch 29/30 - Train Loss: 0.055508
2025-12-18 21:30:35,085 - INFO - Epoch 30/30 - Train Loss: 0.055204
2025-12-18 21:30:35,188 - INFO - 
====== 测试集结果（OT变化量预测，标准化后） ======
2025-12-18 21:30:35,189 - INFO - MAE  = 0.0048
2025-12-18 21:30:35,189 - INFO - RMSE = 0.0082
2025-12-18 21:30:35,190 - INFO - 
====== 测试集结果（OT变化量预测，原始尺度） ======
2025-12-18 21:30:35,190 - INFO - MAE  = 2.0118
2025-12-18 21:30:35,190 - INFO - RMSE = 3.4410
2025-12-18 21:30:35,194 - INFO - 模型已保存到: ckpt\20251218_212955\model_20251218_212955.pth
2025-12-18 21:30:35,235 - INFO - 预测结果已保存到: ckpt\20251218_212955\predictions_20251218_212955.csv
2025-12-18 21:30:36,078 - INFO - 可视化图已保存到: ckpt\20251218_212955\visualization_20251218_212955.png
2025-12-18 21:30:36,080 - INFO - ==================================================
2025-12-18 21:30:36,081 - INFO - 程序运行完成！
2025-12-18 21:30:36,081 - INFO - 所有文件已保存到: ckpt\20251218_212955
